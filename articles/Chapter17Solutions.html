<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ecostats">
<title>Chapter 17 -- Studying co-occurrence patterns -- Exercise solutions and Code Boxes • ecostats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 17 -- Studying co-occurrence patterns -- Exercise solutions and Code Boxes">
<meta property="og:description" content="ecostats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ecostats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ecostats.html">About ecostats</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Chapter Solutions</h6>
    <a class="dropdown-item" href="../articles/Chapter1Solutions.html">Chapter 1 -- 'STATS 101' Revision -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter2Solutions.html">Chapter 2 -- An importance equivalence result -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter3Solutions.html">Chapter 3 -- Regression with multiple predictor variables -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter4Solutions.html">Chapter 4 -- Linear models -- anything goes -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter5Solutions.html">Chapter 5 -- Model selection -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter6Solutions.html">Chapter 6 -- Mixed effect models -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter7Solutions.html">Chapter 7 -- Correlated samples in times, space, phylogeny... -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter8Solutions.html">Chapter 8 -- Wiggly Models -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter9Solutions.html">Chapter 9 -- Design-based inference -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter10Solutions.html">Chapter 10 -- Analysing discrete data -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter11Solutions.html">Chapter 11 -- Multivariate analysis -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter12Solutions.html">Chapter 12 -- Visualising many responses -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter13Solutions.html">Chapter 13 -- Allometric line-fitting -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter14Solutions.html">Chapter 14 -- Multivariate abundances -- inference about environmental associations -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter15Solutions.html">Chapter 15 -- Predicting multivariate abundances -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter16Solutions.html">Chapter 16 -- Understanding variation in environmental response across taxa -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter17Solutions.html">Chapter 17 -- Studying co-occurrence patterns -- Exercise solutions and Code Boxes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Glossary of functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dwarton/ecostats">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Chapter 17 -- Studying co-occurrence patterns -- Exercise solutions and Code Boxes</h1>
                        <h4 data-toc-skip class="author">David Warton</h4>
            
            <h4 data-toc-skip class="date">2022-08-25</h4>
      
      
      <div class="d-none name"><code>Chapter17Solutions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="exercise-17-1-co-occurrence-in-hunting-spider-data">Exercise 17.1: Co-occurrence in hunting spider data<a class="anchor" aria-label="anchor" href="#exercise-17-1-co-occurrence-in-hunting-spider-data"></a>
</h2>
<p><em>Petrus would like to think about co-occurrence of hunting spider species. He wants to know which species co-occur, and to what extent can these co-occurrence patterns be explained by joint response to environmental gradients.</em></p>
<p><em>What approach should he used to look at these questions?</em></p>
<p>He is clearly after methods for studying co-occurrence, so he wants to do covariance modelling on <span class="math inline">\(\Sigma\)</span>, e.g. using latent variables or graphical modelling.</p>
</div>
<div class="section level2">
<h2 id="code-box-17-1-estimating-co-occurrence-patterns-using-a-copula-model">Code Box 17.1: Estimating co-occurrence patterns using a copula model<a class="anchor" aria-label="anchor" href="#code-box-17-1-estimating-co-occurrence-patterns-using-a-copula-model"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mvabund</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ecoCopula</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spiderAbund</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund.html" class="external-link">mvabund</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span>
<span><span class="va">spider_glmInt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html" class="external-link">manyglm</a></span><span class="op">(</span><span class="va">spiderAbund</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">ord_spiderInt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">spider_glmInt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_spiderInt</span>, biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">#for a biplot</span></span>
<span><span class="co"># now plot a correlation matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gclus</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: cluster</span></span>
<span><span class="va">sortVars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/gclus/man/order.html" class="external-link">order.single</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; corrplot 0.92 loaded</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>, <span class="va">sortVars</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"lower"</span>, diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/code17.1-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="code-box-17-2-co-occurrence-patterns-explained-by-environmental-variables">Code Box 17.2: Co-occurrence patterns explained by environmental variables<a class="anchor" aria-label="anchor" href="#code-box-17-2-co-occurrence-patterns-explained-by-environmental-variables"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spider_glmX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html" class="external-link">manyglm</a></span><span class="op">(</span><span class="va">spiderAbund</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">ord_spiderX</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">spider_glmX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_spiderX</span>,biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderX</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>,<span class="va">sortVars</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"lower"</span>,diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/code17.2-1.png" width="768"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderX</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ss</span>, <span class="fl">1</span><span class="op">-</span><span class="va">ss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">ss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.4777865 4.1584074 0.4438986</span></span>
<span><span class="va">absCor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderX</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">absCor</span>, <span class="fl">1</span><span class="op">-</span><span class="va">absCor</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">absCor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 52.5120572 22.1936170  0.5773615</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercise-17-2-spider-presence-absence">Exercise 17.2: Spider presence-absence<a class="anchor" aria-label="anchor" href="#exercise-17-2-spider-presence-absence"></a>
</h2>
<p><em>Repeat the analyses of Code Box 17.1 on presence-absence data, which you can construct using <code>spiderPA=pmin(spiderAbund,1)</code>. Estimate the correlation matrix.</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spiderPA</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">spiderAbund</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">spiderPA_glmInt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html" class="external-link">manyglm</a></span><span class="op">(</span><span class="va">spiderPA</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span>, family<span class="op">=</span><span class="st">"cloglog"</span><span class="op">)</span></span>
<span><span class="va">ord_spiderPAInt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">spiderPA_glmInt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_spiderPAInt</span>, biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">#for a biplot</span></span>
<span><span class="co"># now plot a correlation matrix</span></span>
<span><span class="va">sortVars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/gclus/man/order.html" class="external-link">order.single</a></span><span class="op">(</span><span class="va">ord_spiderPAInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderPAInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>, <span class="va">sortVars</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"lower"</span>,</span>
<span>diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/ex17.2-1.png" width="768"></p>
<p><em>How does the correlation matrix compare to Figure 17.2b?</em></p>
<p>Correlations tend to be smaller, they range from about -0.4 up to 0.4.</p>
<p><em>Calculate the sum of squared loadings, with and without predictors, as in Code Box 17.2. Are the values smaller for the presence/absence data?</em></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spiderPA_glmX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html" class="external-link">manyglm</a></span><span class="op">(</span><span class="va">spiderPA</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span>, family<span class="op">=</span><span class="st">"cloglog"</span><span class="op">)</span></span>
<span><span class="va">ord_spiderPAX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">spiderPA_glmX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_spiderPAX</span>, biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderPAX</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>,<span class="va">sortVars</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"lower"</span>, diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/code17.2variation-1.png" width="768"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderPAInt</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderPAX</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ss</span>, <span class="fl">1</span><span class="op">-</span><span class="va">ss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">ss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.5312318 0.6609464 0.8541354</span></span>
<span><span class="va">absCor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderPAInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderPAX</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">spiderPA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">absCor</span>, <span class="fl">1</span><span class="op">-</span><span class="va">absCor</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">absCor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 31.9204555  1.6798318  0.9473744</span></span></code></pre></div>
<p><em>Is this what you expected?</em></p>
<p>The fact that correlations became weaker is expected. But interestingly, predictors were able to explain most of the correlation, with responses being close to uncorrelated after environmental variables were included.</p>
<p><em>Are your conclusions any different to Code Box 17.2, in terms of the extent to which patterns in co-occurrence can be explained by environmental variables?</em></p>
<p>I guess you would conclude here that most (more than two thirds) of co-occurrence in presence-absence can be explained by environmental variables, whereas this number was about half when looking at abundance.</p>
</div>
<div class="section level2">
<h2 id="exercise-17-3-co-occurrence-in-bird-communities">Exercise 17.3: Co-occurrence in bird communities<a class="anchor" aria-label="anchor" href="#exercise-17-3-co-occurrence-in-bird-communities"></a>
</h2>
<p><em>Françoise visited 51 sites near Lyon, France, and estimated abundance of 40 different species of birds (by listening to bird songs for 15 minutes) (Tatibouët, 1981). He would like to understand bird co-occurrence, and the extent to which it is explained by predictors related to urbanisation. Load the data and fit ordinal regressions to each response:</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">aviurba</span><span class="op">)</span></span>
<span><span class="va">abund</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund.html" class="external-link">mvabund</a></span><span class="op">(</span><span class="va">aviurba</span><span class="op">$</span><span class="va">fau</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal" class="external-link">ordinal</a></span><span class="op">)</span></span>
<span><span class="va">ft_birdsInt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyany.html" class="external-link">manyany</a></span><span class="op">(</span><span class="va">abund</span><span class="op">~</span><span class="fl">1</span>, <span class="st">"clm"</span>, family<span class="op">=</span><span class="st">"ordinal"</span>, data<span class="op">=</span><span class="va">aviurba</span><span class="op">$</span><span class="va">mil</span><span class="op">)</span></span></code></pre></div>
<p><em>Use cord to fit a latent variable model and estimate the correlation matrix.</em></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ord_birdsInt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">ft_birdsInt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_birdsInt</span>, biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sortBirdVars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/gclus/man/order.html" class="external-link">order.single</a></span><span class="op">(</span><span class="va">ord_birdsInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_birdsInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortBirdVars</span>, <span class="va">sortBirdVars</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"lower"</span>, diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/ex17.3cord-1.png" width="768"></p>
<p>Looks like nothing much is happening here!</p>
<p><em>Add fields to the model, to study the extent to which presence or absence of fields explains co-occurrence patterns. Calculate the sum of squared loadings, for latent variable models with and without fields as a predictor.</em></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ft_birdsX</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyany.html" class="external-link">manyany</a></span><span class="op">(</span><span class="va">abund</span><span class="op">~</span><span class="va">fields</span>, <span class="st">"clm"</span>, family<span class="op">=</span><span class="st">"ordinal"</span>, data<span class="op">=</span><span class="va">aviurba</span><span class="op">$</span><span class="va">mil</span><span class="op">)</span></span>
<span><span class="va">ord_birdsX</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">ft_birdsX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ord_birdsX</span>,biplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_birdsX</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortBirdVars</span>,<span class="va">sortBirdVars</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"lower"</span>,diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/ex17.3X-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_birdsInt</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_birdsX</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ss</span>, <span class="fl">1</span><span class="op">-</span><span class="va">ss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">ss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.8849203 4.2228725 0.1355289</span></span>
<span><span class="va">absCor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_birdsInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_birdsX</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">abund</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">absCor</span>, <span class="fl">1</span><span class="op">-</span><span class="va">absCor</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">absCor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 87.6556088 73.0835750  0.1662419</span></span></code></pre></div>
<p><em>What can you conclude about co-occurrence patterns of these birds, and the extent to which they are explained by presence or absence of <code>fields</code>?</em></p>
<p>The proportion of co-occurrence patterns that can be explained is relatively small, so I guess we can say that <code>fields</code> is not a major driver of co-occurrence patterns of birds.</p>
<p>The <code>ordinal</code> package has a bug in it (in version 2019.12) so it conflicts with <code>lme4</code> (specifically it overwrites the <code>ranef</code> function), [issue posted on Github] (<a href="https://github.com/runehaubo/ordinal/issues/48" class="external-link uri">https://github.com/runehaubo/ordinal/issues/48</a>). So if you are running analyses using both packages, you need to <em>detach the <code>ordinal</code> package</em> before continuing…</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">"package:ordinal"</span>, unload<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: 'ordinal' namespace cannot be unloaded:</span></span>
<span><span class="co">#&gt;   namespace 'ordinal' is imported by 'ecoCopula' so cannot be unloaded</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-box-17-3-a-copula-graphical-model-for-petruss-spider-data">Code Box 17.3: A copula graphical model for Petrus’s spider data<a class="anchor" aria-label="anchor" href="#code-box-17-3-a-copula-graphical-model-for-petruss-spider-data"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">graph_spiderInt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cgr.html" class="external-link">cgr</a></span><span class="op">(</span><span class="va">spider_glmInt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">graph_spiderInt</span>, vary.edge.lwd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">graph_spiderX</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cgr.html" class="external-link">cgr</a></span><span class="op">(</span><span class="va">spider_glmX</span>, <span class="va">graph_spiderInt</span><span class="op">$</span><span class="va">all_graphs</span><span class="op">$</span><span class="va">lambda.opt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cgr(spider_glmX, graph_spiderInt$all_graphs$lambda.opt): 'best' model</span></span>
<span><span class="co">#&gt; selected among supplied lambda only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">graph_spiderX</span>, vary.edge.lwd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/code17.3-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">absCor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">graph_spiderInt</span><span class="op">$</span><span class="va">best_graph</span><span class="op">$</span><span class="va">cov</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">graph_spiderX</span><span class="op">$</span><span class="va">best_graph</span><span class="op">$</span><span class="va">cov</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">absCor</span>, <span class="fl">1</span><span class="op">-</span><span class="va">absCor</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">absCor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 45.151380 16.787329  0.628199</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercise-17-4-does-soil-dryness-explain-co-occurrence-patterns-in-petruss-data">Exercise 17.4: Does soil dryness explain co-occurrence patterns in Petrus’s data?<a class="anchor" aria-label="anchor" href="#exercise-17-4-does-soil-dryness-explain-co-occurrence-patterns-in-petruss-data"></a>
</h2>
<p><em>Recall that in Figure 16.1a, <em>Alopecosa accentuata</em>, <em>Alopecosa fabrilis</em> and <em>Arctosa perita</em> decreased in response to soil dryness, while all other species increased. Note that the “unconstrained” correlation matrix of Figure 17.2b found negative correlation patterns between these species and most others. To what extent do contrasting responses to soil dryness explain the negative correlations of Figure 17.2b? Answer this question by fitting a covariance model of your choice to the spider data with and without soil dryness as a predictor.</em></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spider_glmSoil</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html" class="external-link">manyglm</a></span><span class="op">(</span><span class="va">spiderAbund</span><span class="op">~</span><span class="va">soil.dry</span>,data<span class="op">=</span><span class="va">spider</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">ord_spiderSoil</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ecoCopula/man/cord.html" class="external-link">cord</a></span><span class="op">(</span><span class="va">spider_glmSoil</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>,<span class="va">sortVars</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"lower"</span>,diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">ord_spiderSoil</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">sortVars</span>,<span class="va">sortVars</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"lower"</span>,diag<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter17Solutions_files/figure-html/ex17.4-1.png" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ord_spiderSoil</span><span class="op">$</span><span class="va">loadings</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ss</span>, <span class="fl">1</span><span class="op">-</span><span class="va">ss</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">ss</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.4777865 5.9162267 0.2088265</span></span>
<span><span class="va">absCor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderInt</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ord_spiderSoil</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">absCor</span>, <span class="fl">1</span><span class="op">-</span><span class="va">absCor</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">absCor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 52.512057 40.215152  0.234173</span></span></code></pre></div>
<p>This explained less covariation than the model with all six environmental variables, more like a fifth of it rather than half. But anyway, the negative correlations we saw previously (above, left) do involve <code>Arctperi</code>, <code>Alopacce</code> and <code>Alopfabr</code>, the three species that have a negative association with <code>soil.dry</code>. These three species are all positively correlated with each other but negatively correlated with most other species.</p>
<p>After including <code>soil.dry</code> in the model (above, right), most of the negative associations have disappeared, and these species become largely uncorrelated with all others. So while plenty of the covariation does not seem to be explained by <code>soil.dry</code>, it is doing a good job of capturing the negative co-occurrence patterns in spider abundance.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
