<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ecostats">
<title>Chapter 3 -- Regression with multiple predictor variables -- Exercise solutions and Code Boxes • ecostats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 3 -- Regression with multiple predictor variables -- Exercise solutions and Code Boxes">
<meta property="og:description" content="ecostats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ecostats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/eco-stats.html">About ecostats</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Chapter Solutions</h6>
    <a class="dropdown-item" href="../articles/Chapter1Solutions.html">Chapter 1 -- 'STATS 101' Revision -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter2Solutions.html">Chapter 2 -- An importance equivalence result -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter3Solutions.html">Chapter 3 -- Regression with multiple predictor variables -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter4Solutions.html">Chapter 4 -- Linear models -- anything goes -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter5Solutions.html">Chapter 5 -- Model selection -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter6Solutions.html">Chapter 6 -- Mixed effect models -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter7Solutions.html">Chapter 7 -- Correlated samples in times, space, phylogeny... -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter8Solutions.html">Chapter 8 -- Wiggly Models -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter9Solutions.html">Chapter 9 -- Design-based inference -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter10Solutions.html">Chapter 10 -- Analysing discrete data -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter11Solutions.html">Chapter 11 -- Multivariate analysis -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter12Solutions.html">Chapter 12 -- Visualising many responses -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter13Solutions.html">Chapter 13 -- Allometric line-fitting -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter14Solutions.html">Chapter 14 -- Multivariate abundances -- inference about environmental associations -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter15Solutions.html">Chapter 15 -- Predicting multivariate abundances -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter16Solutions.html">Chapter 16 -- Understanding variation in environmental response across taxa -- Exercise solutions and Code Boxes</a>
    <a class="dropdown-item" href="../articles/Chapter17Solutions.html">Chapter 17 -- Studying co-occurrence patterns -- Exercise solutions and Code Boxes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Glossary of functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dwarton/ecostats">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Chapter 3 -- Regression with multiple predictor variables -- Exercise solutions and Code Boxes</h1>
                        <h4 data-toc-skip class="author">David
Warton</h4>
            
            <h4 data-toc-skip class="date">2022-07-12</h4>
      
      
      <div class="d-none name"><code>Chapter3Solutions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="exercise-3-1-global-plant-height">Exercise 3.1: Global plant height<a class="anchor" aria-label="anchor" href="#exercise-3-1-global-plant-height"></a>
</h2>
<p><em>Can latitudinal variation in plant height be explained by
climate?</em> This is a hypothesis testing question: we want to know if
there is a relationship between height and latitude, after controlling
for climate.</p>
<p>This research question now involves several variables:
<em>height</em> (quantitative), <em>latitude</em> (quantitative) and
<em>climate</em>. How climate is measured has not been specified here,
but it typically involves quantitative measurements of temperature,
precipitation and often related variables.</p>
<p>We will answer this question using multiple regression, a type of
linear model, see Code Box 3.2.</p>
</div>
<div class="section level2">
<h2 id="code-box-3-1-simple-linear-regression-of-global-plant-height-data---predicting">Code Box 3.1: Simple linear regression of global plant height data -
predicting<a class="anchor" aria-label="anchor" href="#code-box-3-1-simple-linear-regression-of-global-plant-height-data---predicting"></a>
</h2>
<p>height as a function of latitude only.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ecostats</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: mvabund</span>
 <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="va">ft_heightLat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">lat</span>, data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_heightLat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = height ~ lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -15.740  -7.905  -5.289   4.409  68.326 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept) 17.00815    2.61957   6.493 1.66e-09 ***</span>
<span class="co">#&gt; lat         -0.20759    0.06818  -3.045  0.00282 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 13.59 on 129 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.06705,    Adjusted R-squared:  0.05982 </span>
<span class="co">#&gt; F-statistic: 9.271 on 1 and 129 DF,  p-value: 0.002823</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-box-3-2-multiple-linear-regression-of-global-plant-height-data-on-r-predicting">Code Box 3.2: Multiple linear regression of global plant height data
on R – predicting<a class="anchor" aria-label="anchor" href="#code-box-3-2-multiple-linear-regression-of-global-plant-height-data-on-r-predicting"></a>
</h2>
<p>plant height as a function of annual precipitation and latitude.</p>
<p>Note the code is almost the same as for simple linear regression –
just add an extra predictor variable!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ft_heightRainLat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">rain</span><span class="op">+</span><span class="va">lat</span>, data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_heightRainLat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = height ~ rain + lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -16.965  -7.144  -3.529   2.317  65.434 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">#&gt; (Intercept)  5.223135   4.317148   1.210  0.22856   </span>
<span class="co">#&gt; rain         0.005503   0.001637   3.363  0.00102 **</span>
<span class="co">#&gt; lat         -0.052507   0.080197  -0.655  0.51381   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 13.08 on 128 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.1428, Adjusted R-squared:  0.1294 </span>
<span class="co">#&gt; F-statistic: 10.66 on 2 and 128 DF,  p-value: 5.226e-05</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-box-3-3-r-code-to-produce-the-plots-of-figure-3-1">Code Box 3.3: R code to produce the plots of Figure 3.1<a class="anchor" aria-label="anchor" href="#code-box-3-3-r-code-to-produce-the-plots-of-figure-3-1"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: carData</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html" class="external-link">avPlots</a></span><span class="op">(</span><span class="va">ft_heightLat</span>, terms <span class="op">=</span> <span class="op">~</span><span class="va">lat</span>, xlab<span class="op">=</span><span class="st">"Latitude"</span>, ylab<span class="op">=</span><span class="st">"Height"</span>,
grid<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">##left plot</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/avPlots-1.png" width="384"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/car/man/avPlots.html" class="external-link">avPlots</a></span><span class="op">(</span><span class="va">ft_heightRainLat</span>, terms <span class="op">=</span> <span class="op">~</span><span class="va">lat</span>, xlab<span class="op">=</span><span class="st">"Latitude|rain"</span>,
ylab<span class="op">=</span><span class="st">"Height|rain"</span>, grid<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## right plot</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/avPlots-2.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="code-box-3-4-tests-of-multiple-parameters-on-r-using-the-anova-function">Code Box 3.4: Tests of multiple parameters on R using the anova
function<a class="anchor" aria-label="anchor" href="#code-box-3-4-tests-of-multiple-parameters-on-r-using-the-anova-function"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ft_Lat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">lat</span>,data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="va">ft_LatClim</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">lat</span><span class="op">+</span><span class="va">rain</span><span class="op">+</span><span class="va">temp</span>,data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ft_Lat</span>,<span class="va">ft_LatClim</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: height ~ lat</span>
<span class="co">#&gt; Model 2: height ~ lat + rain + temp</span>
<span class="co">#&gt;   Res.Df   RSS Df Sum of Sq     F   Pr(&gt;F)   </span>
<span class="co">#&gt; 1    129 23818                               </span>
<span class="co">#&gt; 2    127 21794  2    2023.9 5.897 0.003556 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-box-3-5-multi-collinearity-example-adding-rainfall-in-the-wettest-month-rain-wetm-to-a-model-that-already-has-annual-precipitation-rain-">Code Box 3.5: Multi-collinearity example – adding rainfall in the
wettest month (rain.wetm) to a model that already has annual
precipitation (rain).<a class="anchor" aria-label="anchor" href="#code-box-3-5-multi-collinearity-example-adding-rainfall-in-the-wettest-month-rain-wetm-to-a-model-that-already-has-annual-precipitation-rain-"></a>
</h2>
<p>Note that standard errors are larger and suddenly everything is
non-significant.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ft_climproblems</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">height</span><span class="op">~</span><span class="va">rain</span><span class="op">+</span><span class="va">rain.wetm</span><span class="op">+</span><span class="va">lat</span>,data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_climproblems</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = height ~ rain + rain.wetm + lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -16.868  -7.286  -3.472   2.345  65.196 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept)  4.907914   4.607746   1.065    0.289</span>
<span class="co">#&gt; rain         0.004911   0.003370   1.457    0.148</span>
<span class="co">#&gt; rain.wetm    0.004686   0.023283   0.201    0.841</span>
<span class="co">#&gt; lat         -0.046927   0.085140  -0.551    0.582</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 13.12 on 127 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.143,  Adjusted R-squared:  0.1228 </span>
<span class="co">#&gt; F-statistic: 7.066 on 3 and 127 DF,  p-value: 0.0001977</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercise-3-2-plant-height-data-transform-response">Exercise 3.2: Plant height data – transform response?<a class="anchor" aria-label="anchor" href="#exercise-3-2-plant-height-data-transform-response"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
 <span class="va">globalPlants</span><span class="op">$</span><span class="va">loght</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
 <span class="va">ft_logheightRainLat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">loght</span><span class="op">~</span><span class="va">rain</span><span class="op">+</span><span class="va">lat</span>, data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_logheightRainLat</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/heightRainLat-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_logheightRainLat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = loght ~ rain + lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.3508 -1.0542 -0.0468  0.9755  3.2702 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">#&gt; (Intercept)  1.4974481  0.4752634   3.151  0.00203 **</span>
<span class="co">#&gt; rain         0.0005400  0.0001802   2.997  0.00328 **</span>
<span class="co">#&gt; lat         -0.0273834  0.0088286  -3.102  0.00237 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.439 on 128 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.2548, Adjusted R-squared:  0.2432 </span>
<span class="co">#&gt; F-statistic: 21.89 on 2 and 128 DF,  p-value: 6.68e-09</span></code></pre></div>
<p>These diagnostic plots look a lot better.</p>
<p>But now results have changed – the effect of latitude, after
controlling for rainfall, is significant! These results are more
trustworthy than the previous ones because assumptions are looking
reasonable now, whereas before we had strong right-skew.</p>
<p>Results changing is not entirely unexpected here. Least squares
methods have low power when applied to strongly skewed data. What
happened here is that there was a (fairly strong) pattern in the data,
with latitudinal effects that are not explained by rainfall, but we
couldn’t see this before because data were strongly skewed, which makes
it hard to see anything.</p>
</div>
<div class="section level2">
<h2 id="exercise-3-3-plant-height-skewed-rainfall-data">Exercise 3.3: Plant height – skewed rainfall data?<a class="anchor" aria-label="anchor" href="#exercise-3-3-plant-height-skewed-rainfall-data"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
 <span class="va">globalPlants</span><span class="op">$</span><span class="va">logRain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">rain</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">rain</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">logRain</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/logRain-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ft_logheightlogRainLat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">loght</span><span class="op">~</span><span class="va">logRain</span><span class="op">+</span><span class="va">lat</span>, data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_logheightlogRainLat</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/logRain-2.png" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_logheightlogRainLat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = loght ~ logRain + lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.3620 -1.0032  0.0473  0.9843  3.1241 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">#&gt; (Intercept) -1.952796   1.485134  -1.315  0.19090   </span>
<span class="co">#&gt; logRain      0.603392   0.191128   3.157  0.00199 **</span>
<span class="co">#&gt; lat         -0.027740   0.008599  -3.226  0.00160 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.434 on 128 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.2601, Adjusted R-squared:  0.2486 </span>
<span class="co">#&gt; F-statistic:  22.5 on 2 and 128 DF,  p-value: 4.224e-09</span></code></pre></div>
<p>The histogram for rainfall is slightly right-skewed, although it’s
not super-scary. Reanalysing data we still get pretty good-loking
diagnostic plots and results look very similar – <span class="math inline">\(R^2\)</span> is almost the same, <span class="math inline">\(P\)</span>-values are still very significant.</p>
</div>
<div class="section level2">
<h2 id="code-box-3-6-computing-variance-inflation-factors-to-check-for-multi-collinearity-">Code Box 3.6: Computing variance inflation factors to check for
multi-collinearity.<a class="anchor" aria-label="anchor" href="#code-box-3-6-computing-variance-inflation-factors-to-check-for-multi-collinearity-"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">ft_heightRainLat</span><span class="op">)</span>
<span class="co">#&gt;     rain      lat </span>
<span class="co">#&gt; 1.494158 1.494158</span>
 <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">ft_climproblems</span><span class="op">)</span>
<span class="co">#&gt;      rain rain.wetm       lat </span>
<span class="co">#&gt;  6.287835  7.031092  1.671396</span></code></pre></div>
<p>Clearly adding rain.wetm to the model has done some damage (but to
rain only, not so much to lat).</p>
</div>
<div class="section level2">
<h2 id="code-box-3-7-correlations-and-pairwise-scatterplots-to-look-for-multi-collinearity-">Code Box 3.7: Correlations and pairwise scatterplots to look for
multi-collinearity.<a class="anchor" aria-label="anchor" href="#code-box-3-7-correlations-and-pairwise-scatterplots-to-look-for-multi-collinearity-"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">lat</span>,<span class="va">globalPlants</span><span class="op">$</span><span class="va">rain</span>,<span class="va">globalPlants</span><span class="op">$</span><span class="va">rain.wetm</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt;                        globalPlants.lat globalPlants.rain</span>
<span class="co">#&gt; globalPlants.lat              1.0000000        -0.5750884</span>
<span class="co">#&gt; globalPlants.rain            -0.5750884         1.0000000</span>
<span class="co">#&gt; globalPlants.rain.wetm       -0.6336210         0.9170080</span>
<span class="co">#&gt;                        globalPlants.rain.wetm</span>
<span class="co">#&gt; globalPlants.lat                    -0.633621</span>
<span class="co">#&gt; globalPlants.rain                    0.917008</span>
<span class="co">#&gt; globalPlants.rain.wetm               1.000000</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/heightPairs-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="exercise-3-4-snails-on-seaweed">Exercise 3.4: Snails on seaweed<a class="anchor" aria-label="anchor" href="#exercise-3-4-snails-on-seaweed"></a>
</h2>
<p><em>Does invertebrate density change with isolation?</em> This
research question asks for a hypothesis test: is there are relationship
between invertebrate density and isolation.</p>
<p>There are two variables – invertebrate density (quantitative) and
distance of isolation, which was set experimentally at 0, 2 or 10 metres
(categorical).</p>
<p>So I’m thinking ANOVA.</p>
</div>
<div class="section level2">
<h2 id="code-box-3-8-analysis-of-variance-in-r-for-the-seaweed-data-of-exercise-1-13-using">Code Box 3.8: Analysis of variance in R for the seaweed data of
Exercise 1.13 using<a class="anchor" aria-label="anchor" href="#code-box-3-8-analysis-of-variance-in-r-for-the-seaweed-data-of-exercise-1-13-using"></a>
</h2>
<p>lm.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">)</span>
 <span class="va">seaweed</span><span class="op">$</span><span class="va">Dist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">$</span><span class="va">Dist</span><span class="op">)</span>
 <span class="va">ft_seaweed</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Total</span><span class="op">~</span><span class="va">Dist</span>,data<span class="op">=</span><span class="va">seaweed</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ft_seaweed</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Total</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Dist       2 300.25 150.123  8.5596 0.0005902 ***</span>
<span class="co">#&gt; Residuals 54 947.08  17.539                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>There is strong evidence of a <code>Dist</code> effect.</p>
</div>
<div class="section level2">
<h2 id="code-box-3-9-running-confint-on-the-seaweed-data-doesnt-give-us-what-we">Code Box 3.9: Running confint on the seaweed data doesn’t give us
what we<a class="anchor" aria-label="anchor" href="#code-box-3-9-running-confint-on-the-seaweed-data-doesnt-give-us-what-we"></a>
</h2>
<p>want.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">ft_seaweed</span><span class="op">)</span>
<span class="co">#&gt;                 2.5 %   97.5 %</span>
<span class="co">#&gt; (Intercept) 2.7785049 6.533423</span>
<span class="co">#&gt; Dist2       2.9211057 8.460686</span>
<span class="co">#&gt; Dist10      0.4107071 5.720963</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-box-3-10-analysis-of-variance-of-the-seaweed-data-of-exercise-1-13-with-tukeys-multiple-comparisons-via-the-multcomp-package-">Code Box 3.10: Analysis of variance of the seaweed data of Exercise
1.13 with Tukey’s multiple comparisons via the multcomp package.<a class="anchor" aria-label="anchor" href="#code-box-3-10-analysis-of-variance-of-the-seaweed-data-of-exercise-1-13-with-tukeys-multiple-comparisons-via-the-multcomp-package-"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: mvtnorm</span>
<span class="co">#&gt; Loading required package: survival</span>
<span class="co">#&gt; Loading required package: TH.data</span>
<span class="co">#&gt; Loading required package: MASS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'TH.data'</span>
<span class="co">#&gt; The following object is masked from 'package:MASS':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     geyser</span>
 <span class="va">contDist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>Dist<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span> <span class="co"># telling R to compare on the Dist factor</span>
 <span class="va">compDist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">ft_seaweed</span>, linfct<span class="op">=</span><span class="va">contDist</span><span class="op">)</span> <span class="co"># run multiple comparisions</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">compDist</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: lm(formula = Total ~ Dist, data = seaweed)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; 2 - 0 == 0     5.691      1.382   4.119   &lt;0.001 ***</span>
<span class="co">#&gt; 10 - 0 == 0    3.066      1.324   2.315   0.0621 .  </span>
<span class="co">#&gt; 10 - 2 == 0   -2.625      1.382  -1.900   0.1485    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; (Adjusted p values reported -- single-step method)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compDist</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20multcomp-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="exercise-3-5-plant-height-climate-explains-patterns">Exercise 3.5: Plant height – climate explains patterns?<a class="anchor" aria-label="anchor" href="#exercise-3-5-plant-height-climate-explains-patterns"></a>
</h2>
<p>I will take climate to mean temperature (<em>temp</em>) and rainfall
(<em>rain</em>).</p>
<p>So a good plan here would be to fit a multiple regression model, to
appropriately transformed data, and see if latitude explains any
variation not captured by climate.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
 <span class="va">globalPlants</span><span class="op">$</span><span class="va">logRain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">rain</span><span class="op">)</span>
 <span class="va">globalPlants</span><span class="op">$</span><span class="va">logHt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
 <span class="va">ft_logheightClim</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">loght</span><span class="op">~</span><span class="va">logRain</span><span class="op">+</span><span class="va">temp</span><span class="op">+</span><span class="va">lat</span>, data<span class="op">=</span><span class="va">globalPlants</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_logheightClim</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/logClimate-1.png" width="768"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ft_logheightClim</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = loght ~ logRain + temp + lat, data = globalPlants)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.2777 -1.0191 -0.0016  0.9328  3.2730 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">#&gt; (Intercept) -3.45043    1.96520  -1.756  0.08154 . </span>
<span class="co">#&gt; logRain      0.64012    0.19347   3.309  0.00122 **</span>
<span class="co">#&gt; temp         0.03855    0.03319   1.162  0.24760   </span>
<span class="co">#&gt; lat         -0.00753    0.01940  -0.388  0.69859   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.432 on 127 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.2679, Adjusted R-squared:  0.2506 </span>
<span class="co">#&gt; F-statistic: 15.49 on 3 and 127 DF,  p-value: 1.2e-08</span></code></pre></div>
<p>In terms of minding our P’s and Q’s:</p>
<p><strong>Q’s</strong> our research question suggests we are primarily
interested in seeing if there is an effect of latitude after controlling
for climate, hence primary interest is in the bottom row of the above
summmary table.</p>
<p><strong>P’s</strong></p>
<ul>
<li>
<em>(conditional) independence</em> requires randomly sampled sites.
This wasn’t actually done so we are left waving our arms and thinking
hard about possible sources of dependence… sites tended to be relatively
far apart geographically so are unlikely to exhibit dependence. We could
check for this using a spatial correlogram (see Chapter 7).</li>
<li>
<em>normality</em> no trend on normal quantile plot suggests no
evidence against this assumption</li>
<li>
<em>equal variance</em> no fan-shape pattern on residual vs fits
plot suggests this looks OK</li>
<li>
<em>linearity</em> no U-shape on residual vs fits plots suggests
this looks reasonable.</li>
</ul>
<p>After adding <em>temp</em> to the model, there is no longer any
evidence of a latitudinal effect. So latitudinal variation in height can
be explained by climate, in the sense that there is no evidence of a
latitudinal effect after controlling for climate.</p>
<p>The main reason for this is that temperature and latitude are highly
correlated (as below), hence we can think of latitude primarily as a
surrogate for temperature. It is not immediately obvious however if
plants tend to grow taller towards the equator because it is warmer
(hence <em>temp</em> is driving this relationship) or because of reduced
seasonality and more even day lengths (hence <em>lat</em> is the
driver).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">globalPlants</span><span class="op">$</span><span class="va">lat</span>,<span class="va">globalPlants</span><span class="op">$</span><span class="va">rain</span>,<span class="va">globalPlants</span><span class="op">$</span><span class="va">temp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt;                   globalPlants.lat globalPlants.rain globalPlants.temp</span>
<span class="co">#&gt; globalPlants.lat         1.0000000        -0.5750884        -0.9158796</span>
<span class="co">#&gt; globalPlants.rain       -0.5750884         1.0000000         0.4786965</span>
<span class="co">#&gt; globalPlants.temp       -0.9158796         0.4786965         1.0000000</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/Climate%20pairs-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="exercise-3-6-habitat-con-guration-study-mind-your-ps-and-qs">Exercise 3.6: Habitat conguration study { mind your P’s and
Q’s<a class="anchor" aria-label="anchor" href="#exercise-3-6-habitat-con-guration-study-mind-your-ps-and-qs"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">Total</span><span class="op">~</span><span class="va">Dist</span>,data<span class="op">=</span><span class="va">seaweed</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20box-1.png" width="480"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">$</span><span class="va">Total</span>,<span class="va">seaweed</span><span class="op">$</span><span class="va">Dist</span>,<span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt; seaweed$Dist: 0</span>
<span class="co">#&gt; [1] 2.108063</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; seaweed$Dist: 2</span>
<span class="co">#&gt; [1] 5.507271</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; seaweed$Dist: 10</span>
<span class="co">#&gt; [1] 4.456622</span></code></pre></div>
<p>Small means have small variances. There is a boundary at zero and
data are being “pushed up” against it, with <code>Total</code> tending
to take small values near zero for <code>Dist=0</code>, with less than
half the sd of <code>Dist=2</code> or <code>Dist=10</code>.</p>
<p>There is also a suggestion of non-normality when checking assumptions
on the fitted ANOVA model:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_seaweed</span>,which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20logre%20plot-1.png" width="768"></p>
<p>Notice that in the quantile plot that points get close to the lower
bound in the middle of the plot and get near the top of it at large
values – this is mildly suggestive of skew. We similarly see an
increasing trend in the scale-location plot, although it does stay
within its simulation bounds. Notice these are only subtle patterns and
not particularly strong.</p>
<p>(As an aside, note there is no envelope visible on the residual vs
fits plot. This happens because we are fitting an ANOVA model, which
ends up with a residuals mean exactly equal to zero for all treatments,
hence no mean trend on the res vs fits plot for all fitted values, just
a flat line at zero. Put another way, non-linearity isn’t an assumption
to worry about in ANOVA models, the fitted model goes exactly through
the mean of each treatment.)</p>
<p>We can try to address the suggestion of skew this using
log-transformation:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">seaweed</span><span class="op">$</span><span class="va">logTot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">$</span><span class="va">Total</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">logTot</span><span class="op">~</span><span class="va">Dist</span>,data<span class="op">=</span><span class="va">seaweed</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20trans-1.png" width="384"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">$</span><span class="va">logTot</span>,<span class="va">seaweed</span><span class="op">$</span><span class="va">Dist</span>,<span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt; seaweed$Dist: 0</span>
<span class="co">#&gt; [1] 0.4423775</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; seaweed$Dist: 2</span>
<span class="co">#&gt; [1] 0.667999</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; seaweed$Dist: 10</span>
<span class="co">#&gt; [1] 0.5421633</span></code></pre></div>
<p>This is looking pretty good now, let’s run with that.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.75</span>,<span class="fl">0.75</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
 <span class="va">ft_loghabconf</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">logTot</span><span class="op">~</span><span class="va">Dist</span>,data<span class="op">=</span><span class="va">seaweed</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_loghabconf</span>,which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20logre-1.png" width="768"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ft_loghabconf</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: logTot</span>
<span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; Dist       2  4.8786 2.43929   8.011 0.0008981 ***</span>
<span class="co">#&gt; Residuals 54 16.4427 0.30449                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
 <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span>
 <span class="va">contDist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>Dist<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span> <span class="co"># telling R to compare on the Dist factor</span>
 <span class="va">compDistlog</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">ft_loghabconf</span>, linfct<span class="op">=</span><span class="va">contDist</span><span class="op">)</span> <span class="co"># run multiple comparisions</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">compDistlog</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: lm(formula = logTot ~ Dist, data = seaweed)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; 2 - 0 == 0    0.7117     0.1820   3.910 0.000763 ***</span>
<span class="co">#&gt; 10 - 0 == 0   0.4584     0.1745   2.627 0.029596 *  </span>
<span class="co">#&gt; 10 - 2 == 0  -0.2533     0.1820  -1.392 0.352228    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; (Adjusted p values reported -- single-step method)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compDistlog</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20logre-2.png" width="768"></p>
<p>And the main change in results here is that there is now evidence
that mean <code>logTot</code> is different between <code>Dist==0</code>
and <code>Dist==10</code> now as well as between <code>Dist==0</code>
and <code>Dist==2</code>. Again this is an example of being able to
better see patterns when assumptions are closer to being satisfied (in
particular, removing right-skew from response when fitting a linear
model).</p>
</div>
<div class="section level2">
<h2 id="exercise-3-7-habitat-con-guration-study-small-plots">Exercise 3.7: Habitat conguration study { small plots<a class="anchor" aria-label="anchor" href="#exercise-3-7-habitat-con-guration-study-small-plots"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">habSmall</span><span class="op">=</span><span class="va">seaweed</span><span class="op">[</span><span class="va">seaweed</span><span class="op">$</span><span class="va">Size</span><span class="op">==</span><span class="st">"SMALL"</span>,<span class="op">]</span>
 <span class="va">ft_smhabconf</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">logTot</span><span class="op">~</span><span class="va">Dist</span>,data<span class="op">=</span><span class="va">habSmall</span><span class="op">)</span>
 <span class="fu"><a href="../reference/plotenvelope.html">plotenvelope</a></span><span class="op">(</span><span class="va">ft_smhabconf</span>,which<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20SMALL-1.png" width="384"><img src="Chapter3Solutions_files/figure-html/seaweed%20SMALL-2.png" width="384"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">ft_smhabconf</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: logTot</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; Dist       2 2.8974 1.44870  4.9358 0.0149 *</span>
<span class="co">#&gt; Residuals 27 7.9247 0.29351                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
 <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span>
 <span class="va">contDist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>Dist<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span> <span class="co"># telling R to compare on the Dist factor</span>
 <span class="va">compDistsm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">ft_smhabconf</span>, linfct<span class="op">=</span><span class="va">contDist</span><span class="op">)</span> <span class="co"># run multiple comparisons</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">compDistsm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: lm(formula = logTot ~ Dist, data = habSmall)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">#&gt; 2 - 0 == 0    0.7165     0.2423   2.957   0.0171 *</span>
<span class="co">#&gt; 10 - 0 == 0   0.5808     0.2423   2.397   0.0597 .</span>
<span class="co">#&gt; 10 - 2 == 0  -0.1357     0.2423  -0.560   0.8422  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; (Adjusted p values reported -- single-step method)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compDistsm</span><span class="op">)</span></code></pre></div>
<p><img src="Chapter3Solutions_files/figure-html/seaweed%20SMALL-3.png" width="384"></p>
<p>Results are now less significant, with only marginal evidence of a
difference in mean <code>logTot</code> between <code>Dist==0</code> and
<code>Dist==10</code>. This is expected because we have almost halved
our sample size:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">seaweed</span><span class="op">)</span>
<span class="co">#&gt; [1] 57 23</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">habSmall</span><span class="op">)</span>
<span class="co">#&gt; [1] 30 23</span></code></pre></div>
<p>By reducing our sample size, we are less able to see patterns in the
data (because there is less data to look for patterns in!).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
